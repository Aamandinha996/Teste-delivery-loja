<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Calculadora Delivery H칤brida</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; background:#f7f9fc; padding:20px; color:#222; }
    .card { max-width:520px; margin:0 auto; background:white; padding:20px; border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,0.06); }
    input { width:100%; padding:10px; margin:8px 0; border-radius:6px; border:1px solid #ddd; }
    button { padding:10px 14px; border-radius:8px; border:none; background:#2b7de9; color:white; cursor:pointer; }
    .small { font-size:0.9rem; color:#666; margin-top:8px; }
  </style>
</head>
<body>
  <div class="card">
    <h2>游닍 Calculadora de Delivery H칤brida</h2>
    <p><strong>Origem (loja):</strong> Estrada dos Mirandas, S칚o Paulo - SP</p>

    <label>CEP do cliente (somente n칰meros):</label>
    <input id="cep" placeholder="Ex: 01234567">

    <label>Rua (opcional):</label>
    <input id="rua" placeholder="Ex: Rua Exemplo">

    <label>N칰mero da casa (opcional):</label>
    <input id="numero" placeholder="Ex: 100">

    <button onclick="calcularDelivery()" style="margin-top:10px;">Calcular Delivery</button>

    <p id="resultado" class="small"></p>
  </div>

  <script>
    const lojaEndereco = "Estrada dos Mirandas, S칚o Paulo - SP";
    const precoPorBloco = 8; // R$8
    const kmPorBloco = 5;    // cada 5 km

    // Dist칙ncia aproximada por CEP (para c치lculo r치pido)
    const cepDistancia = {
      "01000000": 2,
      "01100000": 3,
      "01200000": 5,
      "01300000": 6,
      "01400000": 7,
      "01500000": 8,
      "01600000": 10,
      // adicione mais CEPs que voc칡 atende
    };

    function calcPriceFromKm(distKm) {
      return Math.ceil(distKm / kmPorBloco) * precoPorBloco;
    }

    function callDistanceMatrix(originAddress, destAddress) {
      return new Promise((resolve, reject) => {
        const service = new google.maps.DistanceMatrixService();
        service.getDistanceMatrix({
          origins: [originAddress],
          destinations: [destAddress],
          travelMode: 'DRIVING',
          unitSystem: google.maps.UnitSystem.METRIC
        }, (response, status) => {
          if (status !== 'OK') reject('Erro DistanceMatrix: ' + status);
          else resolve(response);
        });
      });
    }

    async function calcularDelivery() {
      const cep = (document.getElementById('cep').value || '').replace(/\D/g,'');
      const rua = document.getElementById('rua').value.trim();
      const numero = document.getElementById('numero').value.trim();
      const output = document.getElementById('resultado');

      if (!cep) {
        output.textContent = 'Por favor, digite um CEP v치lido.';
        return;
      }

      // Se o usu치rio digitar rua + n칰mero, tenta c치lculo real via Google Maps
      if (rua && numero) {
        const enderecoCompleto = `${rua}, ${numero}, ${cep}, Brasil`;
        output.textContent = 'Calculando dist칙ncia real...';

        try {
          const dm = await callDistanceMatrix(lojaEndereco, enderecoCompleto);
          const elemento = dm.rows[0].elements[0];
          if (elemento.status !== 'OK') {
            output.textContent = 'N칚o foi poss칤vel calcular a dist칙ncia. Verifique o endere칞o.';
            return;
          }
          const distanciaKm = elemento.distance.value / 1000;
          const distanciaTexto = elemento.distance.text;
          const preco = calcPriceFromKm(distanciaKm);
          output.innerHTML = `游뚱 Dist칙ncia: <strong>${distanciaTexto}</strong><br>游눯 Valor do delivery: <strong>R$ ${preco},00</strong>`;
        } catch (err) {
          output.textContent = 'Erro ao calcular dist칙ncia: ' + err;
        }
      } else {
        // Caso contr치rio, usa dist칙ncia aproximada por CEP
        let distanciaKm = cepDistancia[cep] || 8; // padr칚o 8 km
        const preco = calcPriceFromKm(distanciaKm);
        output.innerHTML = `游뚱 Dist칙ncia aproximada: <strong>${distanciaKm} km</strong><br>游눯 Valor do delivery: <strong>R$ ${preco},00</strong>`;
      }
    }
  </script>

  <!-- Google Maps API -->
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDiyfkCBwncJwOFA9lZ5Ng6W3M_qvQuVtQ&libraries=places"></script>
</body>
</html>


